---
layout: mypost
title: iOS 开启 DoH
date: 2025-12-26
published: True
categories: iOS
tags: 
 - iOS
---

## 创建DoH

登录 Cloudflare，[点击](https://one.dash.cloudflare.com/?to=/:account/networks/resolvers-proxies/locations/add-non-authed) 创建 DNS 位置，位置名称自定义，并如图勾选，然后依次点击 继续 - 完成 完成创建

![DoH](屏幕截图 2025-12-26 101340.png)

记录好 **基于 HTTPS 的 DNS** 的值，形如 `https://xxxxxx.cloudflare-gateway.com/dns-query` 后面将会用到

## 创建描述文件

替换 DoH 接入地址后将文件重命名为 `dns-over-https.mobileconfig` 后下载到 iOS 设备，然后在 iOS 设备进入 **设置** → **通用** →  **VPN 与设备管理**，找到证书（显示为 `EMAS HTTPDNS DoH Configuration`)，点击安装

```xm
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
   <key>PayloadContent</key>
   <array>
      <dict>
         <key>DNSSettings</key>
         <dict>
            <key>DNSProtocol</key>
            <string>HTTPS</string>
            <key>ServerURL</key>
            <!---- 把此处的地址替换为 DoH 接入地址 --->
            <string>https://xxxxxx.cloudflare-gateway.com/dns-query</string>
         </dict>
         <key>PayloadDescription</key>
         <string>Configures iOS to use EMAS HTTPDNS DoH</string>
         <key>PayloadDisplayName</key>
         <string>EMAS HTTPDNS DoH</string>
         <key>PayloadIdentifier</key>
         <string>com.apple.dnsSettings.managed.9B498EC0C-EF6C-44F0-BFB7-0000658B99AC</string>
         <key>PayloadType</key>
         <string>com.apple.dnsSettings.managed</string>
         <key>PayloadUUID</key>
         <string>465AB183-5E34-4794-9BEB-B5327CF61F27</string>
         <key>PayloadVersion</key>
         <integer>1</integer>
         <key>ProhibitDisablement</key>
         <false/>
      </dict>
   </array>
   <key>PayloadDescription</key>
   <string>Adds EMAS HTTPDNS DoH configuration to iOS</string>
   <key>PayloadDisplayName</key>
   <string>EMAS HTTPDNS DoH Configuration</string>
   <key>PayloadIdentifier</key>
   <string>com.emas.apple-dns</string>
   <key>PayloadRemovalDisallowed</key>
   <false/>
   <key>PayloadType</key>
   <string>Configuration</string>
   <key>PayloadUUID</key>
   <string>130E6D6F-69A2-4515-9D77-99342CB9AE76</string>
   <key>PayloadVersion</key>
   <integer>1</integer>
</dict>
</plist>
```



## 参考链接

- [Cloudflare/dns-location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/)

- [iOS使用DoH直连L站 ](https://linux.do/t/topic/1352136)
